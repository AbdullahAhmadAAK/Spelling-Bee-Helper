<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <!-- <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    /> -->
  </head>
  <body>
    <!-- <header class="d-flex bg-black justify-content-around white-text">
      <div class="navbar">
        <img src="dice-removebg-preview.png" alt="" class="navbar-logo" />
        <h4 id="header-label" class="navbar-label">AAK's Beetist</h4>
        <h5 class="navbar-page">WEBSITE 1</h5>
        <h5 class="navbar-page">WEBSITE 2</h5>
        <h5 class="navbar-page">WEBSITE 3</h5>
      </div>
    </header> -->

    <!-- <h1>AAK's Beetist</h1>
    <h3>
      Are your parents too busy to help you with dictations and spelling bee
      preparations? Can't find anyone to help you prepare?
    </h3>
    <h2>Worry no more! AAK's Beetist has you covered.</h2> -->

    <label for="new_word">Add word</label>
    <input type="text" id="new_word" value="" />

    <label for="new_words_list">Add all words</label>
    <input type="text" id="new_words_list" value="" />
    
    <button id="add-word-btn" onclick="addWord()">Add Word</button>
    <button id="add-words-list-btn" onclick="addWordsList()">Add Words List</button>

    <button id="play-audio">Listen to 1 Word</button>
    <button id="play-all-audios">Listen to All Words</button>
    <button onclick="renderListHidden()">Hide Words</button>
    <button onclick="renderList()">Show Words</button>
    <button id="save-list" onclick="saveList()">Save List</button>
    <button id="restore-list" onclick="restoreList()">Restore List</button>
    <button onclick="removeList()">Remove List</button>
    <!-- <input
        type="button"
        value="Play/Restart the words!"
        onclick="BotStarter();"
      />
      <input type="button" value="Pause the practice!" onclick="BotPauser();" />
      <input
        type="button"
        value="Resume the practice!"
        onclick="BotResumer();"
      /> -->

      <div style="min-height: 40px; border: 2px solid black;">
        <h4 style="text-decoration: underline">Current Words List</h4>
        <ol id="words_list">

        </ol>
      </div>
    
    <div id="sounds-zone"></div>

    <script>
      let words_list = [];
      

      const addWord = () => {
        const new_word = document.getElementById("new_word").value;
        words_list.push(new_word);
        renderList();
        clearInputs();
      }
      const addWordsList = () => {
        const input_words_list = document.getElementById("new_words_list").value;
        let words_array = input_words_list.split(",");
        words_list = words_array;
        renderList();
        clearInputs();
      }
      const clearInputs = () => {
        document.getElementById("new_word").value = "";
        document.getElementById("new_words_list").value = "";
      }
      async function reciteWord(url) {
        const response = await fetch(url);
        var data = await response.json();

        console.log(data[0].phonetics[0].audio); // this is string for mp3 file
        const mp3_src = data[0].phonetics[0].audio;

        const sound_box_element = document.getElementById("sounds-zone");

        const audio_element = document.createElement("audio");
        audio_element.setAttribute("autoplay", "");
        // audio_element.setAttribute("controls", "");

        const source_element = document.createElement("source");
        source_element.setAttribute("src", mp3_src);
        source_element.setAttribute("type", "audio/mp3");

        audio_element.appendChild(source_element);
        sound_box_element.appendChild(audio_element);
      }
      const saveList = () => {
        localStorage.setItem("wordsArray", JSON.stringify(words_list));
      };
      const restoreList = () => {
        words_list = JSON.parse(localStorage.getItem("wordsArray"));
        renderList();
      };
      const renderList = () => {
        var listitems_html = "";
        words_list.forEach(word => {
         listitems_html += "<li>"+word+"</li>";
        });
        document.getElementById("words_list").innerHTML = listitems_html;
      }
      const removeList = () => {
        words_list = [];
        localStorage.setItem("wordsArray", JSON.stringify(words_list));
        renderList();
      }
      const renderListHidden = () => {
        var listitems_hidden_html = "";
        words_list.forEach(word => {
          listitems_hidden_html += "<li>**********</li>";
        });
        document.getElementById("words_list").innerHTML = listitems_hidden_html;
      }

      const listen_button = document.getElementById("play-audio");
      listen_button.onclick = async function () {
     
        /* NEW LOGIC (different response format for each) */
        
        // if 1st api has phonetics, recite that
        // if not, then recite from 2nd api phonetics,
        // if not, then recite from 3rd api phonetics


        reciteWord("https://api.dictionaryapi.dev/api/v2/entries/en/"+words_list[0]);
        setTimeout( () => {
            reciteWord("https://api.dictionaryapi.dev/api/v2/entries/en/"+words_list[0]);
            words_list.shift();
            renderListHidden();
          }, 
          4000
        );
        
        
      };
      
      // not working
      const listen_all_button = document.getElementById("play-all-audios");
      listen_all_button.onclick = async function () {
        words_list.forEach(word => {

          setTimeout(() => {
            
            
            /* NEW LOGIC (different response format for each) */
          
            // if 1st api has phonetics, recite that
            // if not, then recite from 2nd api phonetics,
            // if not, then recite from 3rd api phonetics


            reciteWord("https://api.dictionaryapi.dev/api/v2/entries/en/"+word);
            setTimeout( () => {
                reciteWord("https://api.dictionaryapi.dev/api/v2/entries/en/"+word);
                words_list.shift();
                renderListHidden();
              }, 4000);


          }, 5000);
          
        });
      }
    </script>
  </body>
</html>
